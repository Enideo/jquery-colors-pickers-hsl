/*
 Copyright 2010 Enideo. Released under dual MIT and GPL licenses.
*/
(function(d){function u(a,b,c){if(b in a)return a[b](c);else if(b=="RGB"||"RGB"in e.convertModels[b]){if(b!="RGB")c=e.convertModels[b].RGB(c);for(var f in a)if(f=="RGB"||f in e.convertModels.RGB){if(f!="RGB")c=e.convertModels.RGB[f](c);c=d.colors.formats.array3Octet1Normalized.fromModel.RGB(c);return a[f](c)}}throw"No valid conversion methods for this color model: "+b;}function x(a,b){var c=d.colors.models[this.currentModel].parameterIndexes,f=this.currentModel=="RGB"?this.format("array3Octet1Normalized"):
this.color;if(a){a=a.toLowerCase();if(a in c)if(b!==undefined){this.color[c[a]]=b;this.color=d.colors.models[this.currentModel].sanitize(this.color)}else return f[c[a]];else throw"Parameter not in the current color model: "+a;}else return f;return this}var e=function(a,b,c){if(this instanceof e===false)return new e(a,b,c);if(a&&a instanceof e)return a;this.currentModel=e.defaultModel;if(a){if(typeof a=="string")a=d.trim(a);this.inputColor=a;if(b&&b in e.formats&&e.formats[b].validate(a)===true)this.inputFormat=
b;else{if(c===undefined)c=b;for(b in e.formats)if(e.formats[b].validate(a)===true){this.inputFormat=b;break}}if(this.inputFormat){b=e.formats[b];this.inputModel=c||b.model||e.defaultInputModel;a=u(b.toModel,this.inputModel,a);if(this.inputModel!=this.currentModel){a=e.models[this.inputModel].sanitize(a);a=u(e.convertModels[this.inputModel],this.currentModel,a)}this.color=e.models[this.currentModel].sanitize(a)}}else this.color=e.models[this.currentModel].sanitize();if(this.color)return this;else throw"Color format unknown: "+
a;};e.prototype={get:x,set:x,model:function(a){if(a===undefined)return this.currentModel;else if(a==this.currentModel)return this;else if(a in e.models){this.color=u(e.convertModels[this.currentModel],a,this.color);this.currentModel=a;return this}else throw"Model does not exist";},format:function(a){var b=this.currentModel=="RGB"&&a!=="array3Octet1Normalized"?this.format("array3Octet1Normalized"):this.color;if(a&&a in e.formats)return u(e.formats[a].fromModel,this.currentModel,b);else throw"Format does not exist";
},toString:function(a){if(!a||a in e.formats===false)a=e.defaultString;try{return this.format(a).toString()}catch(b){return this.format(e.defaultString).toString()}},isFormat:function(a){if(a&&a in e.formats)return e.formats[a].validate(this.inputColor);else throw"Format does not exist";},mixWith:function(a,b){var c=0,f,h,i,k;if(typeof b=="number")k=b;f=this.get();i=this.model();if(d.isArray(a))try{h=e(a)}catch(o){for(c=0;c<a.length;c++){if(a[c]instanceof e==false)a[c]=e(a[c]);h=c==0?a[c].model(i):
h.mixWith(a[c],c/(c+1))}}else{if(a instanceof e==false)a=e(a);h=a}h=h.model(i).get();f=f.slice(0);h=h.slice(0);if(k==undefined)k=c?1/(c+1):0.5;for(c=0;c<f.length;c++){if("cycleMixes"in e.models[i]&&e.models[i].cycleMixes[c])if(e.models[i].cycleMixes[c]>0)for(;f[c]>h[c];)h[c]+=e.models[i].cycleMixes[c];else for(;f[c]<h[c];)h[c]+=e.models[i].cycleMixes[c];f[c]=f[c]*k+h[c]*(1-k)}f=e.models[i].sanitize(f);return d.extend(d.colors(),{color:f,currentModel:i})}};e.formats={array3Octet:{validate:function(a,
b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&c<3&&a[c]<=255&&/^\d+$/.test(a[c].toString())||c==3&&a[c]<=1)c++;else break;if(c==b)return true}return false},toModel:{RGB:function(a){return a.slice(0,3)}},fromModel:{RGB:function(a){return a.slice(0,3)}}},array3Octet1Normalized:{validate:function(a){return e.formats.array3Octet.validate(a,4)},toModel:{RGB:function(a){return a.slice(0,4)}},fromModel:{RGB:function(a){var b=0;for(a=a.slice(0,4);b<3;){a[b]=
Math.round(a[b]);b++}return a}}},rgb:{validate:function(a,b){var c=1,f;if(a&&typeof a=="string"&&(f=/^rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)$/.exec(a))){for(;c<4;){f[c]=parseInt(f[c]);if(f[c]<256)c++;else break}if(c==4)if(b){f.shift();return f.slice(0)}else return true}return false},fromModel:{RGB:function(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}},toModel:{RGB:function(a){a=e.formats.rgb.validate(a,true);return a===false?null:a}},model:"RGB"}};e.models={RGB:{sanitize:function(a){var b;
if(!a||!d.isArray(a))a=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);if(b<3){if(a[b]>255)a[b]=255;if(a[b]<0)a[b]=0}else if(b==3){a[b]=parseFloat(a[b]);if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},parameterIndexes:{r:0,g:1,b:2,a:3,red:0,green:1,blue:2,alpha:3}}};e.convertModels={};e.defaultInputModel=e.defaultModel="RGB";e.defaultString=
"rgb";d.colors===undefined&&d.extend({colors:e});var v={HSL:{sanitize:function(a){var b;if(!a||!d.isArray(a))a=[Math.floor(361*Math.random()),Math.floor(101*Math.random()),Math.floor(101*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);a[b]=parseFloat(a[b]);if(b==0){for(;a[b]>360;)a[b]-=360;if(a[b]<0)a[b]+=360}else if(b<3){for(;a[b]>100;)a[b]=100;if(a[b]<0)a[b]=0}else if(b==3){if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},
parameterIndexes:{h:0,s:1,l:2,a:3,hue:0,saturation:1,lightness:2,alpha:3},cycleMixes:[360,0,0,0],reverseCylce:function(a){this.cycleMixes[this.parameterIndexes[a]]*=-1}}},y={array1Circle2Percentage:{validate:function(a,b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&(c==0&&a[c]<=360||(c==1||c==2)&&a[c]<=100||c==3&&a[c]<=1))c++;else break;if(c==b)return true}return false},toModel:{HSL:function(a){return a.slice(0,3)}},fromModel:{HSL:function(a){return a.slice(0,
3)}}},array1Circle2Percentage1Normalized:{validate:function(a){return y.array1Circle2Percentage.validate(a,4)},toModel:{HSL:function(a){return a.slice(0,4)}},fromModel:{HSL:function(a){return a.slice(0,4)}}}};d.extend(true,d.colors.convertModels,{RGB:{HSL:function(a){var b=a[0]/255,c=a[1]/255,f=a[2]/255,h=Math.max(b,c,f),i=Math.min(b,c,f),k=h-i,o=(h+i)/2;if(h==i)b=i=0;else{i=o>0.5?k/(2-h-i):k/(h+i);b=h==b?(c-f)/k+(c<f?6:0):h==c?(f-b)/k+2:(b-c)/k+4;b/=6}return[b*360,i*100,o*100,a[3]]}},HSL:{RGB:function(a){function b(o,
q,n){if(n<0)n+=1;if(n>1)n-=1;return n<1/6?o+(q-o)*6*n:n<0.5?q:n<2/3?o+(q-o)*(2/3-n)*6:o}var c,f,h,i,k;h=a[0]/360;f=a[1]/100;c=a[2]/100;if(f==0)c=f=h=c;else{i=c<0.5?c*(1+f):c+f-c*f;k=2*c-i;c=b(k,i,h+1/3);f=b(k,i,h);h=b(k,i,h-1/3)}return[c*255,f*255,h*255,a[3]]}}});d.extend(d.colors.models,v);d.extend(d.colors.formats,y)})(jQuery);
(function(d){function u(){var g=d("<div/>").css({width:198,backgroundRepeat:"repeat-y",position:"relative",overflow:"hidden"}).addClass("scale"),m=d("<div/>").css({zIndex:1,bottom:0,backgroundRepeat:"repeat-y"}),l=d("<span/>").css({position:"absolute",zIndex:3}),p=d("<span/>").css({bottom:0}).addClass("handle");m.add(p).css({position:"absolute",top:0,left:0,right:0});q=d("<div/>").addClass("hslLiteColorPicker");q.append(g.clone().addClass("h sprite").data("arrayIndex",0).append(m.clone())).append(g.clone().addClass("s").data("arrayIndex",
1).append(m.clone().addClass("sprite").css({backgroundPosition:"-792px 0"})).append(m.clone().addClass("sprite").css({backgroundPosition:"-396px 0"})).append(m.clone().addClass("sprite").css({backgroundPosition:"-594px 0"}))).append(g.clone().addClass("l sprite").data("arrayIndex",2).css({backgroundPosition:"-198px 0"}));o.append(q);n=q.children("div");p.append(l.clone().text("\u25bc")).append(l.clone().text("\u25b2"));l.addClass("outline").css({zIndex:2});p.append(l.clone().text("\u25bc")).append(l.clone().text("\u25b2"));
n.append(p).children().children().each(function(j){var r=d(this),s="top";if(j%2!=0)s="bottom";r.css({left:-r.width()/2-1}).css(s,-r.height()/2)});c=[Math.random()*360,Math.random()*100,Math.random()*100];f=false;h=i=k=null;n.mousedown(x)}function x(g){function m(s){var z=100;s=(s.pageX-j)/200;s=s>1?1:s<0?0:s;if(r==0)z=360;c[r]=s*z;e();d.isFunction(i)&&i(d.colors(c,"array1Circle2Percentage","HSL"));return false}function l(){d.isFunction(k)&&k(d.colors(c,"array1Circle2Percentage","HSL"));d(document).unbind("mousemove",
m).unbind("mouseup",l);q.data("dragging",false)}var p=d(g.currentTarget),j=p.offset().left,r=p.data("arrayIndex");v(d(this).closest(".hslLiteColorPicker").parent());if(f)return true;d.isFunction(h)&&h(d.colors(c,"array1Circle2Percentage","HSL"));if(!q.data("dragging")){d(document).bind("mousemove",m).bind("mouseup",l);q.data("dragging",true)}m(g);return false}function e(){var g,m;n.each(function(){var l=d(this),p=l.data("arrayIndex"),j=100;if(p==0)j=360;l.children("span").css({left:c[p]*200/j})});
if(c[2]>50){m=(c[2]-50)*2/100;g=[m,1-m,0]}else{m=(50-c[2])*2/100;g=[0,1-m,m]}n.filter(".h").children("div").css({backgroundColor:d.colors([0,0,c[2]],"array1Circle2Percentage","HSL").toString("rgb")}).css("opacity",Math.max(m,(100-c[1])/100));n.filter(".s").css({backgroundColor:d.colors([c[0],100,50],"array1Circle2Percentage","HSL").toString("rgb")}).children("div").each(function(l){d(this).css("opacity",g[l])});n.filter(".l").css({backgroundColor:d.colors([c[0],c[1],50],"array1Circle2Percentage",
"HSL").toString("rgb")})}function v(g){o=g;if(o.data("hslLiteColorPickerId")){q=o.children();n=q.children("div.scale");t=o.data("hslLiteColorPickerId");c=b[t].hsl;f=b[t].disabled;h=b[t].onStartChange;i=b[t].onChange;k=b[t].onEndChange}else{t=(new Date).getTime();o.data("hslLiteColorPickerId",t);u();b[t]={hsl:c,disabled:f,onStartChange:h,onChange:i,onEndChange:k}}}function y(){var g,m,l,p,j=[[".hslLiteColorPicker",["display","inline-block"]],[".hslLiteColorPicker>div.scale",["height","1.5em"],["border",
"1px solid #000"],["margin","auto"],["cursor","crosshair"]],[".hslLiteColorPicker>div.scale>span.handle>span",["color","#eee"],["font-size","1.2em"]],[".hslLiteColorPicker>div>span.handle>span.outline",["color","#111"],["font-size","1.4em"]],[".hslLiteColorPicker.disabled>div.scale",["cursor","default"]],[".hslLiteColorPicker.disabled>div.scale>span.handle>span",["opacity","0.5"],["filter","alpha(opacity=50)"]],[".hslLiteColorPicker .sprite",["background-image","url('"+d.colors.pickers.hslLite.pathToImages+
"jquery.colors.pickers.hslLite.sprite.png')"]]],r=document.createElement("style"),s;a=true;/MSIE/.test(navigator.appVersion)||(j=j.concat([[".hslLiteColorPicker .sprite",["background-image","url('data:image/png;charset=\"utf-8\";base64,iVBORw0KGgoAAAANSUhEUgAAA94AAAABEAYAAAB4faoPAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAABFklEQVRYw+1X2w6DIAwFfdD99bKfVkyAbbDGeCk3cTHb6YPNKT3lpG00SmvFy97PvhfOyHddGHM+lsfVvd2O8XP17MeV8mgYvCc8jvt4HSfeOs7xOJ96T279WF3CV5hoKb/uZsQ6l3rObQS3Mam41sTDes7qeWzWqee1d4PLPzK50snEJjRN4XdW6X17eU0jpVLWSmdae28M4cbZjMPxWrzUesYs87e8WB53Xykvr14p77j+vL5et5/n7psQHret983HCM9xwpSxPOfitXip9Ur1r3npdWvz8uqV8qCf4z2c0ZfT/21svTF58W/zrqLj1/Wjn9CPfv6z/rszrdFP6Ec/oR/9hP4Qzxu+F9CPfkI/9gH6w7wnLhg+WFwMyfwAAAAASUVORK5CYII=')"]]]));
r.type="text/css";r.charset="utf-8";r.rel="stylesheet";g=0;for(m=j.length;g<m;g++){s=[j[g][0],"{"];l=1;for(p=j[g].length;l<p;l++)s.push(j[g][l].join(":"),";");s.push("}");j[g]=s.join("")}j=j.join("");g=document.getElementsByTagName("link");if(g.length==0)g=document.getElementsByTagName("style");g.length!=0?document.getElementsByTagName("head")[0].insertBefore(r,g[0]):document.getElementsByTagName("head")[0].appendChild(r);if(r.styleSheet)r.styleSheet.cssText=j;else d(r).text(j)}var a,b={},c,f,h,i,
k,o,q,n,t;d.fn.hslLiteColorPicker=function(g){var m,l=[];if(typeof g=="string"&&this.data("hslLiteColorPickerId"))return g==="color"?d.colors(b[this.data("hslLiteColorPickerId")].hsl,"array1Circle2Percentage","HSL"):b[this.data("hslLiteColorPickerId")][g];a||y();m=this.each(function(){v(d(this));if(typeof g=="object"){var p=d.colors.models.HSL.parameterIndexes,j;for(j in g){if(j in p){b[t].hsl[p[j]]=g[j];delete g[j]}if(j==="color"){if(g[j]instanceof d.colors===false)g[j]=d.colors(g[j]);b[t].hsl=g[j].model("HSL").format("array1Circle2Percentage");
delete g[j]}}d.extend(b[t],g);b[t].hsl=d.colors.models.HSL.sanitize(b[t].hsl).slice(0,3);v(o);if("disabled"in g)g.disabled?q.addClass("disabled"):q.removeClass("disabled");d.isFunction(h)&&h(d.colors(c,"array1Circle2Percentage","HSL"));d.isFunction(i)&&i(d.colors(c,"array1Circle2Percentage","HSL"));d.isFunction(k)&&k(d.colors(c,"array1Circle2Percentage","HSL"))}else g==="hsl"&&l.push(c);e()});return l.length>1?l:l.length==1?l[0]:m};if(d.colors.pickers===undefined)d.colors.pickers={};var w=d("script");
w=w.eq(w.length-1).attr("src").split("/");w.pop();d.colors.pickers.hslLite={pathToImages:w.join("/")+"/"}})(jQuery);
