/*
 Copyright 2010 Enideo. Released under dual MIT and GPL licenses.
*/
(function(d){function v(a,b,c){if(b in a)return a[b](c);else if(b=="RGB"||"RGB"in f.convertModels[b]){if(b!="RGB")c=f.convertModels[b].RGB(c);for(var g in a)if(g=="RGB"||g in f.convertModels.RGB){if(g!="RGB")c=f.convertModels.RGB[g](c);c=d.colors.formats.array3Octet1Normalized.fromModel.RGB(c);return a[g](c)}}throw"No valid conversion methods for this color model: "+b;}function x(a,b){var c=d.colors.models[this.currentModel].parameterIndexes,g=this.currentModel=="RGB"?this.format("array3Octet1Normalized"):
this.color;if(a){a=a.toLowerCase();if(a in c)if(b!==undefined){this.color[c[a]]=b;this.color=d.colors.models[this.currentModel].sanitize(this.color)}else return g[c[a]];else throw"Parameter not in the current color model: "+a;}else return g;return this}var f=function(a,b,c){if(this instanceof f===false)return new f(a,b,c);if(a&&a instanceof f)return a;this.currentModel=f.defaultModel;if(a){if(typeof a=="string")a=d.trim(a);this.inputColor=a;if(b&&b in f.formats&&f.formats[b].validate(a)===true)this.inputFormat=
b;else{if(c===undefined)c=b;for(b in f.formats)if(f.formats[b].validate(a)===true){this.inputFormat=b;break}}if(this.inputFormat){b=f.formats[b];this.inputModel=c||b.model||f.defaultInputModel;a=v(b.toModel,this.inputModel,a);if(this.inputModel!=this.currentModel){a=f.models[this.inputModel].sanitize(a);a=v(f.convertModels[this.inputModel],this.currentModel,a)}this.color=f.models[this.currentModel].sanitize(a)}}else this.color=f.models[this.currentModel].sanitize();if(this.color)return this;else throw"Color format unknown: "+
a;};f.fn=f.prototype={get:x,set:x,model:function(a){if(a===undefined)return this.currentModel;else if(a==this.currentModel)return this;else if(a in f.models){this.color=v(f.convertModels[this.currentModel],a,this.color);this.currentModel=a;return this}else throw"Model does not exist";},format:function(a){var b=this.currentModel=="RGB"&&a!=="array3Octet1Normalized"?this.format("array3Octet1Normalized"):this.color;if(a&&a in f.formats)return v(f.formats[a].fromModel,this.currentModel,b);else throw"Format does not exist";
},toString:function(a){if(!a||a in f.formats===false)a=f.defaultString;try{return this.format(a).toString()}catch(b){return this.format(f.defaultString).toString()}},isFormat:function(a){if(a&&a in f.formats)return f.formats[a].validate(this.inputColor);else throw"Format does not exist";}};f.formats={array3Octet:{validate:function(a,b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&c<3&&a[c]<=255&&/^\d+$/.test(a[c].toString())||c==3&&a[c]<=1)c++;else break;
if(c==b)return true}return false},toModel:{RGB:function(a){return a.slice(0,3)}},fromModel:{RGB:function(a){return a.slice(0,3)}}},array3Octet1Normalized:{validate:function(a){return f.formats.array3Octet.validate(a,4)},toModel:{RGB:function(a){return a.slice(0,4)}},fromModel:{RGB:function(a){var b=0;for(a=a.slice(0,4);b<3;){a[b]=Math.round(a[b]);b++}return a}}},rgb:{validate:function(a,b){var c=1,g;if(a&&typeof a=="string"&&(g=/^rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)$/.exec(a))){for(;c<
4;){g[c]=parseInt(g[c]);if(g[c]<256)c++;else break}if(c==4)if(b){g.shift();return g.slice(0)}else return true}return false},fromModel:{RGB:function(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}},toModel:{RGB:function(a){a=f.formats.rgb.validate(a,true);return a===false?null:a}},model:"RGB"}};f.models={RGB:{sanitize:function(a){var b;if(!a||!d.isArray(a))a=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):
a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);if(b<3){if(a[b]>255)a[b]=255;if(a[b]<0)a[b]=0}else if(b==3){a[b]=parseFloat(a[b]);if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},parameterIndexes:{r:0,g:1,b:2,a:3,red:0,green:1,blue:2,alpha:3}}};f.convertModels={};f.defaultInputModel=f.defaultModel="RGB";f.defaultString="rgb";d.colors===undefined&&d.extend({colors:f});var w={HSL:{sanitize:function(a){var b;if(!a||!d.isArray(a))a=[Math.floor(361*Math.random()),Math.floor(101*Math.random()),
Math.floor(101*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);a[b]=parseFloat(a[b]);if(b==0){for(;a[b]>360;)a[b]-=360;if(a[b]<0)a[b]+=360}else if(b<3){for(;a[b]>100;)a[b]=100;if(a[b]<0)a[b]=0}else if(b==3){if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},parameterIndexes:{h:0,s:1,l:2,a:3,hue:0,saturation:1,lightness:2,alpha:3},cycleMixes:[360,0,0,0],reverseCylce:function(a){this.cycleMixes[this.parameterIndexes[a]]*=
-1}}},y={array1Circle2Percentage:{validate:function(a,b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&(c==0&&a[c]<=360||(c==1||c==2)&&a[c]<=100||c==3&&a[c]<=1))c++;else break;if(c==b)return true}return false},toModel:{HSL:function(a){return a.slice(0,3)}},fromModel:{HSL:function(a){return a.slice(0,3)}}},array1Circle2Percentage1Normalized:{validate:function(a){return y.array1Circle2Percentage.validate(a,4)},toModel:{HSL:function(a){return a.slice(0,4)}},
fromModel:{HSL:function(a){return a.slice(0,4)}}}};d.extend(true,d.colors.convertModels,{RGB:{HSL:function(a){var b=a[0]/255,c=a[1]/255,g=a[2]/255,k=Math.max(b,c,g),l=Math.min(b,c,g),n=k-l,o=(k+l)/2;if(k==l)b=l=0;else{l=o>0.5?n/(2-k-l):n/(k+l);b=k==b?(c-g)/n+(c<g?6:0):k==c?(g-b)/n+2:(b-c)/n+4;b/=6}return[b*360,l*100,o*100,a[3]]}},HSL:{RGB:function(a){function b(o,q,m){if(m<0)m+=1;if(m>1)m-=1;return m<1/6?o+(q-o)*6*m:m<0.5?q:m<2/3?o+(q-o)*(2/3-m)*6:o}var c,g,k,l,n;k=a[0]/360;g=a[1]/100;c=a[2]/100;
if(g==0)c=g=k=c;else{l=c<0.5?c*(1+g):c+g-c*g;n=2*c-l;c=b(n,l,k+1/3);g=b(n,l,k);k=b(n,l,k-1/3)}return[c*255,g*255,k*255,a[3]]}}});d.extend(d.colors.models,w);d.extend(d.colors.formats,y)})(jQuery);
(function(d){function v(){var e=d("<div/>").css({width:198,backgroundRepeat:"repeat-y",position:"relative",overflow:"hidden"}).addClass("scale"),j=d("<div/>").css({zIndex:1,bottom:0,backgroundRepeat:"repeat-y"}),i=d("<span/>").css({position:"absolute",zIndex:3}),p=d("<span/>").css({bottom:0}).addClass("handle");j.add(p).css({position:"absolute",top:0,left:0,right:0});q=d("<div/>").addClass("hslLiteColorPicker");q.append(e.clone().addClass("h sprite").data("arrayIndex",0).append(j.clone())).append(e.clone().addClass("s").data("arrayIndex",
1).append(j.clone().addClass("sprite").css({backgroundPosition:"-792px 0"})).append(j.clone().addClass("sprite").css({backgroundPosition:"-396px 0"})).append(j.clone().addClass("sprite").css({backgroundPosition:"-594px 0"}))).append(e.clone().addClass("l sprite").data("arrayIndex",2).css({backgroundPosition:"-198px 0"}));o.append(q);m=q.children("div");p.append(i.clone().text("\u25bc")).append(i.clone().text("\u25b2"));i.addClass("outline").css({zIndex:2});p.append(i.clone().text("\u25bc")).append(i.clone().text("\u25b2"));
m.append(p).children().children().each(function(h){var r=d(this),s="top";if(h%2!==0)s="bottom";r.css({left:-r.width()/2-1}).css(s,-r.height()/2)});c=[Math.random()*360,Math.random()*100,Math.random()*100];g=false;k=l=n=null;m.mousedown(x)}function x(e){function j(s){var z=100;s=(s.pageX-h)/200;s=s>1?1:s<0?0:s;if(r===0)z=360;c[r]=s*z;f();d.isFunction(l)&&l(d.colors(c,"array1Circle2Percentage","HSL"));return false}function i(){d.isFunction(n)&&n(d.colors(c,"array1Circle2Percentage","HSL"));d(document).unbind("mousemove",
j).unbind("mouseup",i);q.data("dragging",false)}var p=d(e.currentTarget),h=p.offset().left,r=p.data("arrayIndex");w(d(this).closest(".hslLiteColorPicker").parent());if(g)return true;d.isFunction(k)&&k(d.colors(c,"array1Circle2Percentage","HSL"));if(!q.data("dragging")){d(document).bind("mousemove",j).bind("mouseup",i);q.data("dragging",true)}j(e);return false}function f(){var e,j;m.each(function(){var i=d(this),p=i.data("arrayIndex"),h=100;if(p===0)h=360;i.children("span").css({left:c[p]*200/h})});
if(c[2]>50){j=(c[2]-50)*2/100;e=[j,1-j,0]}else{j=(50-c[2])*2/100;e=[0,1-j,j]}e[1]*=0.8;m.filter(".h").children("div").css({backgroundColor:d.colors([0,0,c[2]],"array1Circle2Percentage","HSL").toString("rgb")}).css("opacity",Math.max(j,(100-c[1])/100));m.filter(".s").css({backgroundColor:d.colors([c[0],100,50],"array1Circle2Percentage","HSL").toString("rgb")}).children("div").each(function(i){d(this).css("opacity",e[i])});m.filter(".l").css({backgroundColor:d.colors([c[0],c[1],50],"array1Circle2Percentage",
"HSL").toString("rgb")})}function w(e){o=e;if(o.data("hslLiteColorPickerId")){q=o.children();m=q.children("div.scale");t=o.data("hslLiteColorPickerId");c=b[t].hsl;g=b[t].disabled;k=b[t].onStartChange;l=b[t].onChange;n=b[t].onEndChange}else{t=(new Date).getTime();o.data("hslLiteColorPickerId",t);v();b[t]={hsl:c,disabled:g,onStartChange:k,onChange:l,onEndChange:n}}}function y(){var e,j,i,p,h=[[".hslLiteColorPicker",["display","inline-block"]],[".hslLiteColorPicker>div.scale",["height","1.5em"],["border",
"1px solid #000"],["margin","auto"],["cursor","crosshair"]],[".hslLiteColorPicker>div.scale>span.handle>span",["color","#eee"],["font-size","1.2em"]],[".hslLiteColorPicker>div>span.handle>span.outline",["color","#111"],["font-size","1.4em"]],[".hslLiteColorPicker.disabled>div.scale",["cursor","default"]],[".hslLiteColorPicker.disabled>div.scale>span.handle>span",["opacity","0.5"],["filter","alpha(opacity=50)"]],[".hslLiteColorPicker .sprite",["background-image","url('"+d.colors.pickers.hslLite.pathToImages+
"jquery.colors.pickers.hslLite.sprite.png')"]]],r=document.createElement("style"),s;a=true;/MSIE/.test(navigator.appVersion)||(h=h.concat([[".hslLiteColorPicker .sprite",["background-image","url('data:image/png;charset=\"utf-8\";base64,iVBORw0KGgoAAAANSUhEUgAAA94AAAABEAYAAAB4faoPAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAABFklEQVRYw+1X2w6DIAwFfdD99bKfVkyAbbDGeCk3cTHb6YPNKT3lpG00SmvFy97PvhfOyHddGHM+lsfVvd2O8XP17MeV8mgYvCc8jvt4HSfeOs7xOJ96T279WF3CV5hoKb/uZsQ6l3rObQS3Mam41sTDes7qeWzWqee1d4PLPzK50snEJjRN4XdW6X17eU0jpVLWSmdae28M4cbZjMPxWrzUesYs87e8WB53Xykvr14p77j+vL5et5/n7psQHret983HCM9xwpSxPOfitXip9Ur1r3npdWvz8uqV8qCf4z2c0ZfT/21svTF58W/zrqLj1/Wjn9CPfv6z/rszrdFP6Ec/oR/9hP4Qzxu+F9CPfkI/9gH6w7wnLhg+WFwMyfwAAAAASUVORK5CYII=')"]]]));
r.type="text/css";r.charset="utf-8";r.rel="stylesheet";e=0;for(j=h.length;e<j;e++){s=[h[e][0],"{"];i=1;for(p=h[e].length;i<p;i++)s.push(h[e][i].join(":"),";");s.push("}");h[e]=s.join("")}h=h.join("");e=document.getElementsByTagName("link");if(e.length===0)e=document.getElementsByTagName("style");e.length!==0?document.getElementsByTagName("head")[0].insertBefore(r,e[0]):document.getElementsByTagName("head")[0].appendChild(r);if(r.styleSheet)r.styleSheet.cssText=h;else d(r).text(h)}var a,b={},c,g,k,
l,n,o,q,m,t,u;d.fn.hslLiteColorPicker=function(e){var j,i=[];if(typeof e=="string"&&this.data("hslLiteColorPickerId"))return e==="color"?d.colors(b[this.data("hslLiteColorPickerId")].hsl,"array1Circle2Percentage","HSL"):b[this.data("hslLiteColorPickerId")][e];a||y();j=this.each(function(){w(d(this));if(typeof e=="object"){var p=d.colors.models.HSL.parameterIndexes,h;for(h in e){if(h in p){b[t].hsl[p[h]]=e[h];delete e[h]}if(h==="color"){if(e[h]instanceof d.colors===false)e[h]=d.colors(e[h]);b[t].hsl=
e[h].model("HSL").format("array1Circle2Percentage");delete e[h]}}d.extend(b[t],e);b[t].hsl=d.colors.models.HSL.sanitize(b[t].hsl).slice(0,3);w(o);if("disabled"in e)e.disabled?q.addClass("disabled"):q.removeClass("disabled")}else e==="hsl"&&i.push(c);f()});return i.length>1?i:i.length==1?i[0]:j};if(d.colors.pickers===undefined)d.colors.pickers={};u=d("script[src]");if(u.length>0){u=u.eq(u.length-1).attr("src").split("/");u.pop();u=u.join("/")+"/"}else u="";d.colors.pickers.hslLite={pathToImages:u}})(jQuery);
