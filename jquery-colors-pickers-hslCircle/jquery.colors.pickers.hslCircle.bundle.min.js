/*
 Copyright 2010 Enideo. Released under dual MIT and GPL licenses.
*/
(function(d){function w(a,b,c){if(b in a)return a[b](c);else if(b=="RGB"||"RGB"in e.convertModels[b]){if(b!="RGB")c=e.convertModels[b].RGB(c);for(var f in a)if(f=="RGB"||f in e.convertModels.RGB){if(f!="RGB")c=e.convertModels.RGB[f](c);c=d.colors.formats.array3Octet1Normalized.fromModel.RGB(c);return a[f](c)}}throw"No valid conversion methods for this color model: "+b;}function A(a,b){var c=d.colors.models[this.currentModel].parameterIndexes,f=this.currentModel=="RGB"?this.format("array3Octet1Normalized"):
this.color;if(a){a=a.toLowerCase();if(a in c)if(b!==undefined){this.color[c[a]]=b;this.color=d.colors.models[this.currentModel].sanitize(this.color)}else return f[c[a]];else throw"Parameter not in the current color model: "+a;}else return f;return this}var e=function(a,b,c){if(this instanceof e===false)return new e(a,b,c);if(a&&a instanceof e)return a;this.currentModel=e.defaultModel;if(a){if(typeof a=="string")a=d.trim(a);this.inputColor=a;if(b&&b in e.formats&&e.formats[b].validate(a)===true)this.inputFormat=
b;else{if(c===undefined)c=b;for(b in e.formats)if(e.formats[b].validate(a)===true){this.inputFormat=b;break}}if(this.inputFormat){b=e.formats[b];this.inputModel=c||b.model||e.defaultInputModel;a=w(b.toModel,this.inputModel,a);if(this.inputModel!=this.currentModel){a=e.models[this.inputModel].sanitize(a);a=w(e.convertModels[this.inputModel],this.currentModel,a)}this.color=e.models[this.currentModel].sanitize(a)}}else this.color=e.models[this.currentModel].sanitize();if(this.color)return this;else throw"Color format unknown: "+
a;};e.prototype={get:A,set:A,model:function(a){if(a===undefined)return this.currentModel;else if(a==this.currentModel)return this;else if(a in e.models){this.color=w(e.convertModels[this.currentModel],a,this.color);this.currentModel=a;return this}else throw"Model does not exist";},format:function(a){var b=this.currentModel=="RGB"&&a!=="array3Octet1Normalized"?this.format("array3Octet1Normalized"):this.color;if(a&&a in e.formats)return w(e.formats[a].fromModel,this.currentModel,b);else throw"Format does not exist";
},toString:function(a){if(!a||a in e.formats===false)a=e.defaultString;try{return this.format(a).toString()}catch(b){return this.format(e.defaultString).toString()}},isFormat:function(a){if(a&&a in e.formats)return e.formats[a].validate(this.inputColor);else throw"Format does not exist";},mixWith:function(a,b){var c=0,f,i,k,p;if(typeof b=="number")p=b;f=this.get();k=this.model();if(d.isArray(a))try{i=e(a)}catch(r){for(c=0;c<a.length;c++){if(a[c]instanceof e==false)a[c]=e(a[c]);i=c==0?a[c].model(k):
i.mixWith(a[c],c/(c+1))}}else{if(a instanceof e==false)a=e(a);i=a}i=i.model(k).get();f=f.slice(0);i=i.slice(0);if(p==undefined)p=c?1/(c+1):0.5;for(c=0;c<f.length;c++){if("cycleMixes"in e.models[k]&&e.models[k].cycleMixes[c])if(e.models[k].cycleMixes[c]>0)for(;f[c]>i[c];)i[c]+=e.models[k].cycleMixes[c];else for(;f[c]<i[c];)i[c]+=e.models[k].cycleMixes[c];f[c]=f[c]*p+i[c]*(1-p)}f=e.models[k].sanitize(f);return d.extend(d.colors(),{color:f,currentModel:k})}};e.formats={array3Octet:{validate:function(a,
b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&c<3&&a[c]<=255&&/^\d+$/.test(a[c].toString())||c==3&&a[c]<=1)c++;else break;if(c==b)return true}return false},toModel:{RGB:function(a){return a.slice(0,3)}},fromModel:{RGB:function(a){return a.slice(0,3)}}},array3Octet1Normalized:{validate:function(a){return e.formats.array3Octet.validate(a,4)},toModel:{RGB:function(a){return a.slice(0,4)}},fromModel:{RGB:function(a){var b=0;for(a=a.slice(0,4);b<3;){a[b]=
Math.round(a[b]);b++}return a}}},rgb:{validate:function(a,b){var c=1,f;if(a&&typeof a=="string"&&(f=/^rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)$/.exec(a))){for(;c<4;){f[c]=parseInt(f[c]);if(f[c]<256)c++;else break}if(c==4)if(b){f.shift();return f.slice(0)}else return true}return false},fromModel:{RGB:function(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}},toModel:{RGB:function(a){a=e.formats.rgb.validate(a,true);return a===false?null:a}},model:"RGB"}};e.models={RGB:{sanitize:function(a){var b;
if(!a||!d.isArray(a))a=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);if(b<3){if(a[b]>255)a[b]=255;if(a[b]<0)a[b]=0}else if(b==3){a[b]=parseFloat(a[b]);if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},parameterIndexes:{r:0,g:1,b:2,a:3,red:0,green:1,blue:2,alpha:3}}};e.convertModels={};e.defaultInputModel=e.defaultModel="RGB";e.defaultString=
"rgb";d.colors===undefined&&d.extend({colors:e});var y={HSL:{sanitize:function(a){var b;if(!a||!d.isArray(a))a=[Math.floor(361*Math.random()),Math.floor(101*Math.random()),Math.floor(101*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);a[b]=parseFloat(a[b]);if(b==0){for(;a[b]>360;)a[b]-=360;if(a[b]<0)a[b]+=360}else if(b<3){for(;a[b]>100;)a[b]=100;if(a[b]<0)a[b]=0}else if(b==3){if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},
parameterIndexes:{h:0,s:1,l:2,a:3,hue:0,saturation:1,lightness:2,alpha:3},cycleMixes:[360,0,0,0],reverseCylce:function(a){this.cycleMixes[this.parameterIndexes[a]]*=-1}}},B={array1Circle2Percentage:{validate:function(a,b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&(c==0&&a[c]<=360||(c==1||c==2)&&a[c]<=100||c==3&&a[c]<=1))c++;else break;if(c==b)return true}return false},toModel:{HSL:function(a){return a.slice(0,3)}},fromModel:{HSL:function(a){return a.slice(0,
3)}}},array1Circle2Percentage1Normalized:{validate:function(a){return B.array1Circle2Percentage.validate(a,4)},toModel:{HSL:function(a){return a.slice(0,4)}},fromModel:{HSL:function(a){return a.slice(0,4)}}}};d.extend(true,d.colors.convertModels,{RGB:{HSL:function(a){var b=a[0]/255,c=a[1]/255,f=a[2]/255,i=Math.max(b,c,f),k=Math.min(b,c,f),p=i-k,r=(i+k)/2;if(i==k)b=k=0;else{k=r>0.5?p/(2-i-k):p/(i+k);b=i==b?(c-f)/p+(c<f?6:0):i==c?(f-b)/p+2:(b-c)/p+4;b/=6}return[b*360,k*100,r*100,a[3]]}},HSL:{RGB:function(a){function b(r,
s,q){if(q<0)q+=1;if(q>1)q-=1;return q<1/6?r+(s-r)*6*q:q<0.5?s:q<2/3?r+(s-r)*(2/3-q)*6:r}var c,f,i,k,p;i=a[0]/360;f=a[1]/100;c=a[2]/100;if(f==0)c=f=i=c;else{k=c<0.5?c*(1+f):c+f-c*f;p=2*c-k;c=b(p,k,i+1/3);f=b(p,k,i);i=b(p,k,i-1/3)}return[c*255,f*255,i*255,a[3]]}}});d.extend(d.colors.models,y);d.extend(d.colors.formats,B)})(jQuery);
(function(d){function w(){var g=d("<div/>").addClass("scale"),l=d("<div/>").css({zIndex:1,width:160,height:160}),n=d("<span/>").css({position:"absolute",zIndex:3}),o=n.clone().addClass("outline").css({zIndex:2}),h=d("<span/>").addClass("handle");l.add(h).css({position:"absolute",top:0,left:0});s=d("<div/>").addClass("hslCircleColorPicker").css({position:"relative",width:160,height:185});s.append(g.clone().addClass("h").data("arrayIndex",0).addClass("hSprite").css({width:160,height:160}).append(l.clone().addClass("hSprite").css({backgroundPosition:"-320px 0"})).append(l.clone().addClass("hSprite").css({backgroundPosition:"-160px 0"})));
g.css({overflow:"hidden"});l.css({backgroundRepeat:"repeat-x",width:20,height:100});s.append(g.clone().addClass("s").data("arrayIndex",1).css({width:20,height:100,position:"absolute",top:30,left:70}).append(l.clone().addClass("sSprite").css({backgroundPosition:"0 -200px"})).append(l.clone().addClass("sSprite")).append(l.clone().addClass("sSprite").css({backgroundPosition:"0 -100px"})));s.append(g.clone().addClass("l").data("arrayIndex",2).css({height:20,position:"absolute",top:165,left:0,right:0}));
r.append(s);q=s.children("div");q.each(function(v){var j=d(this);if(v==0){j.append(h.clone().append(n.clone().text("+")).append(o.clone().text("+")));j.children("span").children().each(function(){var m=d(this);m.css({top:-m.height()/2,left:-m.width()/2})})}else if(v==1){j.append(h.clone().append(n.clone().text("\u25b6")).append(n.clone().text("\u25c0")).append(o.clone().text("\u25b6")).append(o.clone().text("\u25c0")));j.children("span").css({right:2}).children().each(function(m){var u=d(this);leftOrRight=
"left";if(m%2!=0)leftOrRight="right";u.css({top:-u.height()/2}).css(leftOrRight,-u.width()/2)})}else if(v==2){j.append(h.clone().append(n.clone().text("\u25bc")).append(n.clone().text("\u25b2")).append(o.clone().text("\u25bc")).append(o.clone().text("\u25b2")));j.children("span").css({bottom:2}).children().each(function(m){var u=d(this);topOrBottom="top";if(m%2!=0)topOrBottom="bottom";u.css({left:-u.width()/2-1}).css(topOrBottom,-u.height()/2)})}});c=[Math.random()*360,Math.random()*100,Math.random()*
100];f=false;i=k=p=null;q.mousedown(A)}function A(g){function l(j){var m=100;if(v==0){j=Math.atan2(j.pageX-h.left,h.top-j.pageY)/6.28;if(j<0)j+=1;m=360}else j=v==1?(100-(j.pageY-h.top))/100:(j.pageX-h.left)/160;j=j>1?1:j<0?0:j;c[v]=j*m;e();d.isFunction(k)&&k(d.colors(c,"array1Circle2Percentage","HSL"));return false}function n(){d.isFunction(p)&&p(d.colors(c,"array1Circle2Percentage","HSL"));d(document).unbind("mousemove",l).unbind("mouseup",n);s.data("dragging",false)}var o=d(g.currentTarget),h=o.offset(),
v=o.data("arrayIndex");if(v==0){h.top+=80;h.left+=80}y(d(this).closest(".hslCircleColorPicker").parent());if(f)return true;d.isFunction(i)&&i(d.colors(c,"array1Circle2Percentage","HSL"));if(!s.data("dragging")){d(document).bind("mousemove",l).bind("mouseup",n);s.data("dragging",true)}l(g);return false}function e(){var g,l;q.each(function(){var o=d(this),h=o.data("arrayIndex");o=o.children("span");if(h==0){h=c[h]/360*6.28;o.css({top:-Math.cos(h)*70+80,left:Math.sin(h)*70+80})}else h==1?o.css({top:98-
c[h]*100/100}):o.css({left:c[h]*160/100})});var n=c[2]/100;l=(100-c[1])/100;g=[n*l,(1-n)*l];if(c[2]>50){l=(c[2]-50)*2/100;g[0]=Math.max(g[0],l)}else{l=(50-c[2])*2/100;g[1]=Math.max(g[1],l)}q.filter(".h").children("div").each(function(o){d(this).css("opacity",g[o])});g=c[2]>50?[l,1-l,0]:[0,1-l,l];q.filter(".s").css({backgroundColor:d.colors([c[0],100,50],"array1Circle2Percentage","HSL").toString("rgb")}).children("div").each(function(o){d(this).css("opacity",g[o])});q.filter(".l").css({backgroundColor:d.colors([c[0],
c[1],50],"array1Circle2Percentage","HSL").toString("rgb")})}function y(g){r=g;if(r.data("hslCircleColorPickerId")){s=r.children();q=s.children("div.scale");t=r.data("hslCircleColorPickerId");c=b[t].hsl;f=b[t].disabled;i=b[t].onStartChange;k=b[t].onChange;p=b[t].onEndChange}else{t=(new Date).getTime();r.data("hslCircleColorPickerId",t);w();b[t]={hsl:c,disabled:f,onStartChange:i,onChange:k,onEndChange:p}}}function B(){function g(l){var n,o,h,v,j=[[".hslCircleColorPicker",["display","inline-block"]],
[".hslCircleColorPicker>div.scale",["border","1px solid #888"],["cursor","crosshair"]],[".hslCircleColorPicker>div.scale.h",["border-width","0 !important"]],[".hslCircleColorPicker>div.scale.s",["cursor","NS-resize"],["cursor","row-resize"]],[".hslCircleColorPicker>div.scale.l",["cursor","EW-resize"],["cursor","col-resize"]],[".hslCircleColorPicker>div.scale>span.handle>span",["color","#eee"],["font-size","16px"]],[".hslCircleColorPicker>div.scale>span.handle>span.outline",["color","#333"],["font-size",
"18px"]],[".hslCircleColorPicker.disabled>div.scale",["cursor","default"]],[".hslCircleColorPicker.disabled>div.scale>span.handle>span",["opacity","0.5"],["filter","alpha(opacity=50)"]]],m,u,x=document.getElementsByTagName("link");if(x.length==0)x=document.getElementsByTagName("style");if(l===true||this.width!=1||this.height!=1)j=j.concat([[".hslCircleColorPicker .hSprite",["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.sprite.h.png')"]],[".hslCircleColorPicker .sSprite",
["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.sprite.s.png')"]],[".hslCircleColorPicker>div.scale.l",["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.l.png')"]]]);else{m=document.createElement("link");m.type="text/css";m.charset="utf-8";m.rel="stylesheet";m.href=d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.css";x.length!=0?document.getElementsByTagName("head")[0].insertBefore(m,
x[0]):document.getElementsByTagName("head")[0].appendChild(m)}m=document.createElement("style");m.type="text/css";m.charset="utf-8";m.rel="stylesheet";n=0;for(o=j.length;n<o;n++){u=[j[n][0],"{"];h=1;for(v=j[n].length;h<v;h++)u.push(j[n][h].join(":"),";");u.push("}");j[n]=u.join("")}j=j.join("");x.length!=0?document.getElementsByTagName("head")[0].insertBefore(m,x[0]):document.getElementsByTagName("head")[0].appendChild(m);if(m.styleSheet)m.styleSheet.cssText=j;else d(m).text(j);l!==true&&d(this).remove()}
a=true;/MSIE/.test(navigator.appVersion)?g(true):d("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==").one("error load",g).appendTo("body")}var a,b={},c,f,i,k,p,r,s,q,t;d.fn.hslCircleColorPicker=function(g){var l,n=[];if(typeof g=="string"&&this.data("hslCircleColorPickerId"))return g==="color"?d.colors(b[this.data("hslCircleColorPickerId")].hsl,"array1Circle2Percentage","HSL"):b[this.data("hslCircleColorPickerId")][g];a||B();l=this.each(function(){y(d(this));
if(typeof g=="object"){var o=d.colors.models.HSL.parameterIndexes,h;for(h in g){if(h in o){b[t].hsl[o[h]]=g[h];delete g[h]}if(h==="color"){if(g[h]instanceof d.colors===false)g[h]=d.colors(g[h]);b[t].hsl=g[h].model("HSL").format("array1Circle2Percentage");delete g[h]}}d.extend(b[t],g);b[t].hsl=d.colors.models.HSL.sanitize(b[t].hsl).slice(0,3);y(r);if("disabled"in g)g.disabled?s.addClass("disabled"):s.removeClass("disabled")}else g==="hsl"&&n.push(c);e()});return n.length>1?n:n.length==1?n[0]:l};if(d.colors.pickers===
undefined)d.colors.pickers={};var z=d("script");z=z.eq(z.length-1).attr("src").split("/");z.pop();d.colors.pickers.hslCircle={pathToImages:z.join("/")+"/"}})(jQuery);
