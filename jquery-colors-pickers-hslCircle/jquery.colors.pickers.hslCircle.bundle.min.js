/*
 Copyright 2010 Enideo. Released under dual MIT and GPL licenses.
*/
(function(d){function w(a,c,b){if(c in a)return a[c](b);else if(c=="RGB"||"RGB"in e.convertModels[c]){if(c!="RGB")b=e.convertModels[c].RGB(b);for(var f in a)if(f=="RGB"||f in e.convertModels.RGB){if(f!="RGB")b=e.convertModels.RGB[f](b);b=d.colors.formats.array3Octet1Normalized.fromModel.RGB(b);return a[f](b)}}throw"No valid conversion methods for this color model: "+c;}function A(a,c){var b=d.colors.models[this.currentModel].parameterIndexes,f=this.currentModel=="RGB"?this.format("array3Octet1Normalized"):
this.color;if(a){a=a.toLowerCase();if(a in b)if(c!==undefined){this.color[b[a]]=c;this.color=d.colors.models[this.currentModel].sanitize(this.color)}else return f[b[a]];else throw"Parameter not in the current color model: "+a;}else return f;return this}var e=function(a,c,b){if(this instanceof e===false)return new e(a,c,b);if(a&&a instanceof e)return a;this.currentModel=e.defaultModel;if(a){if(typeof a=="string")a=d.trim(a);this.inputColor=a;if(c&&c in e.formats&&e.formats[c].validate(a)===true)this.inputFormat=
c;else{if(b===undefined)b=c;for(c in e.formats)if(e.formats[c].validate(a)===true){this.inputFormat=c;break}}if(this.inputFormat){c=e.formats[c];this.inputModel=b||c.model||e.defaultInputModel;a=w(c.toModel,this.inputModel,a);if(this.inputModel!=this.currentModel){a=e.models[this.inputModel].sanitize(a);a=w(e.convertModels[this.inputModel],this.currentModel,a)}this.color=e.models[this.currentModel].sanitize(a)}}else this.color=e.models[this.currentModel].sanitize();if(this.color)return this;else throw"Color format unknown: "+
a;};e.prototype={get:A,set:A,model:function(a){if(a===undefined)return this.currentModel;else if(a==this.currentModel)return this;else if(a in e.models){this.color=w(e.convertModels[this.currentModel],a,this.color);this.currentModel=a;return this}else throw"Model does not exist";},format:function(a){var c=this.currentModel=="RGB"&&a!=="array3Octet1Normalized"?this.format("array3Octet1Normalized"):this.color;if(a&&a in e.formats)return w(e.formats[a].fromModel,this.currentModel,c);else throw"Format does not exist";
},toString:function(a){if(!a||a in e.formats===false)a=e.defaultString;try{return this.format(a).toString()}catch(c){return this.format(e.defaultString).toString()}},isFormat:function(a){if(a&&a in e.formats)return e.formats[a].validate(this.inputColor);else throw"Format does not exist";},mixWith:function(a,c){var b=0,f,h,j,p;if(typeof c=="number")p=c;f=this.get();j=this.model();if(d.isArray(a))try{h=e(a)}catch(r){for(b=0;b<a.length;b++){if(a[b]instanceof e==false)a[b]=e(a[b]);h=b==0?a[b].model(j):
h.mixWith(a[b],b/(b+1))}}else{if(a instanceof e==false)a=e(a);h=a}h=h.model(j).get();f=f.slice(0);h=h.slice(0);if(p==undefined)p=b?1/(b+1):0.5;for(b=0;b<f.length;b++){if("cycleMixes"in e.models[j]&&e.models[j].cycleMixes[b])if(e.models[j].cycleMixes[b]>0)for(;f[b]>h[b];)h[b]+=e.models[j].cycleMixes[b];else for(;f[b]<h[b];)h[b]+=e.models[j].cycleMixes[b];f[b]=f[b]*p+h[b]*(1-p)}f=e.models[j].sanitize(f);return d.extend(d.colors(),{color:f,currentModel:j})}};e.formats={array3Octet:{validate:function(a,
c){var b=0;c=c||3;if(d.isArray(a)&&a.length==c){for(;b<c;)if(typeof a[b]=="number"&&a[b]>=0&&b<3&&a[b]<=255&&/^\d+$/.test(a[b].toString())||b==3&&a[b]<=1)b++;else break;if(b==c)return true}return false},toModel:{RGB:function(a){return a.slice(0,3)}},fromModel:{RGB:function(a){return a.slice(0,3)}}},array3Octet1Normalized:{validate:function(a){return e.formats.array3Octet.validate(a,4)},toModel:{RGB:function(a){return a.slice(0,4)}},fromModel:{RGB:function(a){var c=0;for(a=a.slice(0,4);c<3;){a[c]=
Math.round(a[c]);c++}return a}}},rgb:{validate:function(a,c){var b=1,f;if(a&&typeof a=="string"&&(f=/^rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)$/.exec(a))){for(;b<4;){f[b]=parseInt(f[b]);if(f[b]<256)b++;else break}if(b==4)if(c){f.shift();return f.slice(0)}else return true}return false},fromModel:{RGB:function(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}},toModel:{RGB:function(a){a=e.formats.rgb.validate(a,true);return a===false?null:a}},model:"RGB"}};e.models={RGB:{sanitize:function(a){var c;
if(!a||!d.isArray(a))a=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(c=0;c<a.length;c++){a[c]||(a[c]=0);if(c<3){if(a[c]>255)a[c]=255;if(a[c]<0)a[c]=0}else if(c==3){a[c]=parseFloat(a[c]);if(a[c]>1)a[c]=1;if(a[c]<0)a[c]=0}}return a},parameterIndexes:{r:0,g:1,b:2,a:3,red:0,green:1,blue:2,alpha:3}}};e.convertModels={};e.defaultInputModel=e.defaultModel="RGB";e.defaultString=
"rgb";d.colors===undefined&&d.extend({colors:e});var y={HSL:{sanitize:function(a){var c;if(!a||!d.isArray(a))a=[Math.floor(361*Math.random()),Math.floor(101*Math.random()),Math.floor(101*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(c=0;c<a.length;c++){a[c]||(a[c]=0);a[c]=parseFloat(a[c]);if(c==0){for(;a[c]>360;)a[c]-=360;if(a[c]<0)a[c]+=360}else if(c<3){for(;a[c]>100;)a[c]=100;if(a[c]<0)a[c]=0}else if(c==3){if(a[c]>1)a[c]=1;if(a[c]<0)a[c]=0}}return a},
parameterIndexes:{h:0,s:1,l:2,a:3,hue:0,saturation:1,lightness:2,alpha:3},cycleMixes:[360,0,0,0],reverseCylce:function(a){this.cycleMixes[this.parameterIndexes[a]]*=-1}}},B={array1Circle2Percentage:{validate:function(a,c){var b=0;c=c||3;if(d.isArray(a)&&a.length==c){for(;b<c;)if(typeof a[b]=="number"&&a[b]>=0&&(b==0&&a[b]<=360||(b==1||b==2)&&a[b]<=100||b==3&&a[b]<=1))b++;else break;if(b==c)return true}return false},toModel:{HSL:function(a){return a.slice(0,3)}},fromModel:{HSL:function(a){return a.slice(0,
3)}}},array1Circle2Percentage1Normalized:{validate:function(a){return B.array1Circle2Percentage.validate(a,4)},toModel:{HSL:function(a){return a.slice(0,4)}},fromModel:{HSL:function(a){return a.slice(0,4)}}}};d.extend(true,d.colors.convertModels,{RGB:{HSL:function(a){var c=a[0]/255,b=a[1]/255,f=a[2]/255,h=Math.max(c,b,f),j=Math.min(c,b,f),p=h-j,r=(h+j)/2;if(h==j)c=j=0;else{j=r>0.5?p/(2-h-j):p/(h+j);c=h==c?(b-f)/p+(b<f?6:0):h==b?(f-c)/p+2:(c-b)/p+4;c/=6}return[c*360,j*100,r*100,a[3]]}},HSL:{RGB:function(a){function c(r,
s,q){if(q<0)q+=1;if(q>1)q-=1;return q<1/6?r+(s-r)*6*q:q<0.5?s:q<2/3?r+(s-r)*(2/3-q)*6:r}var b,f,h,j,p;h=a[0]/360;f=a[1]/100;b=a[2]/100;if(f==0)b=f=h=b;else{j=b<0.5?b*(1+f):b+f-b*f;p=2*b-j;b=c(p,j,h+1/3);f=c(p,j,h);h=c(p,j,h-1/3)}return[b*255,f*255,h*255,a[3]]}}});d.extend(d.colors.models,y);d.extend(d.colors.formats,B)})(jQuery);
(function(d){function w(){var g=d("<div/>").addClass("scale"),l=d("<div/>").css({zIndex:1,width:160,height:160}),n=d("<span/>").css({position:"absolute",zIndex:3}),o=n.clone().addClass("outline").css({zIndex:2}),i=d("<span/>").addClass("handle");l.add(i).css({position:"absolute",top:0,left:0});s=d("<div/>").addClass("hslCircleColorPicker").css({position:"relative",width:160,height:185});s.append(g.clone().addClass("h").data("arrayIndex",0).addClass("hSprite").css({width:160,height:160}).append(l.clone().addClass("hSprite").css({backgroundPosition:"-320px 0"})).append(l.clone().addClass("hSprite").css({backgroundPosition:"-160px 0"})));
g.css({overflow:"hidden"});l.css({backgroundRepeat:"repeat-x",width:20,height:100});s.append(g.clone().addClass("s").data("arrayIndex",1).css({width:20,height:100,position:"absolute",top:30,left:70}).append(l.clone().addClass("sSprite").css({backgroundPosition:"0 -200px"})).append(l.clone().addClass("sSprite")).append(l.clone().addClass("sSprite").css({backgroundPosition:"0 -100px"})));s.append(g.clone().addClass("l").data("arrayIndex",2).css({height:20,position:"absolute",top:165,left:0,right:0}));
r.append(s);q=s.children("div");q.each(function(v){var k=d(this);if(v==0){k.append(i.clone().append(n.clone().text("+")).append(o.clone().text("+")));k.children("span").children().each(function(){var m=d(this);m.css({top:-m.height()/2,left:-m.width()/2})})}else if(v==1){k.append(i.clone().append(n.clone().text("\u25b6")).append(n.clone().text("\u25c0")).append(o.clone().text("\u25b6")).append(o.clone().text("\u25c0")));k.children("span").css({right:2}).children().each(function(m){var u=d(this);leftOrRight=
"left";if(m%2!=0)leftOrRight="right";u.css({top:-u.height()/2}).css(leftOrRight,-u.width()/2)})}else if(v==2){k.append(i.clone().append(n.clone().text("\u25bc")).append(n.clone().text("\u25b2")).append(o.clone().text("\u25bc")).append(o.clone().text("\u25b2")));k.children("span").css({bottom:2}).children().each(function(m){var u=d(this);topOrBottom="top";if(m%2!=0)topOrBottom="bottom";u.css({left:-u.width()/2-1}).css(topOrBottom,-u.height()/2)})}});b=[Math.random()*360,Math.random()*100,Math.random()*
100];f=false;h=j=p=null;q.mousedown(A)}function A(g){function l(k){var m=100;if(v==0){k=Math.atan2(k.pageX-i.left,i.top-k.pageY)/6.28;if(k<0)k+=1;m=360}else k=v==1?(100-(k.pageY-i.top))/100:(k.pageX-i.left)/160;k=k>1?1:k<0?0:k;b[v]=k*m;e();d.isFunction(j)&&j(d.colors(b,"array1Circle2Percentage","HSL"));return false}function n(){d.isFunction(p)&&p(d.colors(b,"array1Circle2Percentage","HSL"));d(document).unbind("mousemove",l).unbind("mouseup",n);s.data("dragging",false)}var o=d(g.currentTarget),i=o.offset(),
v=o.data("arrayIndex");if(v==0){i.top+=80;i.left+=80}y(d(this).closest(".hslCircleColorPicker").parent());if(f)return true;d.isFunction(h)&&h(d.colors(b,"array1Circle2Percentage","HSL"));if(!s.data("dragging")){d(document).bind("mousemove",l).bind("mouseup",n);s.data("dragging",true)}l(g);return false}function e(){var g,l;q.each(function(){var o=d(this),i=o.data("arrayIndex");o=o.children("span");if(i==0){i=b[i]/360*6.28;o.css({top:-Math.cos(i)*70+80,left:Math.sin(i)*70+80})}else i==1?o.css({top:98-
b[i]*100/100}):o.css({left:b[i]*160/100})});var n=b[2]/100;l=(100-b[1])/100;g=[n*l,(1-n)*l];if(b[2]>50){l=(b[2]-50)*2/100;g[0]=Math.max(g[0],l)}else{l=(50-b[2])*2/100;g[1]=Math.max(g[1],l)}q.filter(".h").children("div").each(function(o){d(this).css("opacity",g[o])});g=b[2]>50?[l,1-l,0]:[0,1-l,l];q.filter(".s").css({backgroundColor:d.colors([b[0],100,50],"array1Circle2Percentage","HSL").toString("rgb")}).children("div").each(function(o){d(this).css("opacity",g[o])});q.filter(".l").css({backgroundColor:d.colors([b[0],
b[1],50],"array1Circle2Percentage","HSL").toString("rgb")})}function y(g){r=g;if(r.data("hslCircleColorPickerId")){s=r.children();q=s.children("div.scale");t=r.data("hslCircleColorPickerId");b=c[t].hsl;f=c[t].disabled;h=c[t].onStartChange;j=c[t].onChange;p=c[t].onEndChange}else{t=(new Date).getTime();r.data("hslCircleColorPickerId",t);w();c[t]={hsl:b,disabled:f,onStartChange:h,onChange:j,onEndChange:p}}}function B(){function g(l){var n,o,i,v,k=[[".hslCircleColorPicker",["display","inline-block"]],
[".hslCircleColorPicker>div.scale",["border","1px solid #888"],["cursor","crosshair"]],[".hslCircleColorPicker>div.scale.h",["border-width","0 !important"]],[".hslCircleColorPicker>div.scale.s",["cursor","NS-resize"],["cursor","row-resize"]],[".hslCircleColorPicker>div.scale.l",["cursor","EW-resize"],["cursor","col-resize"]],[".hslCircleColorPicker>div.scale>span.handle>span",["color","#eee"],["font-size","16px"]],[".hslCircleColorPicker>div.scale>span.handle>span.outline",["color","#333"],["font-size",
"18px"]],[".hslCircleColorPicker.disabled>div.scale",["cursor","default"]],[".hslCircleColorPicker.disabled>div.scale>span.handle>span",["opacity","0.5"],["filter","alpha(opacity=50)"]]],m,u,x=document.getElementsByTagName("link");if(x.length==0)x=document.getElementsByTagName("style");if(l===true||this.width!=1||this.height!=1)k=k.concat([[".hslCircleColorPicker .hSprite",["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.sprite.h.png')"]],[".hslCircleColorPicker .sSprite",
["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.sprite.s.png')"]],[".hslCircleColorPicker>div.scale.l",["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.l.png')"]]]);else{m=document.createElement("link");m.type="text/css";m.charset="utf-8";m.rel="stylesheet";m.href=d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.css";x.length!=0?document.getElementsByTagName("head")[0].insertBefore(m,
x[0]):document.getElementsByTagName("head")[0].appendChild(m)}m=document.createElement("style");m.type="text/css";m.charset="utf-8";m.rel="stylesheet";n=0;for(o=k.length;n<o;n++){u=[k[n][0],"{"];i=1;for(v=k[n].length;i<v;i++)u.push(k[n][i].join(":"),";");u.push("}");k[n]=u.join("")}k=k.join("");x.length!=0?document.getElementsByTagName("head")[0].insertBefore(m,x[0]):document.getElementsByTagName("head")[0].appendChild(m);if(m.styleSheet)m.styleSheet.cssText=k;else d(m).text(k);l!==true&&d(this).remove()}
a=true;/MSIE/.test(navigator.appVersion)?g(true):d("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==").one("error load",g).appendTo("body")}var a,c={},b,f,h,j,p,r,s,q,t;d.fn.hslCircleColorPicker=function(g){var l,n=[];if(typeof g=="string"&&this.data("hslCircleColorPickerId"))return g==="color"?d.colors(c[this.data("hslCircleColorPickerId")].hsl,"array1Circle2Percentage","HSL"):c[this.data("hslCircleColorPickerId")][g];a||B();l=this.each(function(){y(d(this));
if(typeof g=="object"){var o=d.colors.models.HSL.parameterIndexes,i;for(i in g){if(i in o){c[t].hsl[o[i]]=g[i];delete g[i]}if(i==="color"){if(g[i]instanceof d.colors===false)g[i]=d.colors(g[i]);c[t].hsl=g[i].model("HSL").format("array1Circle2Percentage");delete g[i]}}d.extend(c[t],g);c[t].hsl=d.colors.models.HSL.sanitize(c[t].hsl).slice(0,3);y(r);if("disabled"in g)g.disabled?s.addClass("disabled"):s.removeClass("disabled");d.isFunction(h)&&h(d.colors(b,"array1Circle2Percentage","HSL"));d.isFunction(j)&&
j(d.colors(b,"array1Circle2Percentage","HSL"));d.isFunction(p)&&p(d.colors(b,"array1Circle2Percentage","HSL"))}else g==="hsl"&&n.push(b);e()});return n.length>1?n:n.length==1?n[0]:l};if(d.colors.pickers===undefined)d.colors.pickers={};var z=d("script");z=z.eq(z.length-1).attr("src").split("/");z.pop();d.colors.pickers.hslCircle={pathToImages:z.join("/")+"/"}})(jQuery);
