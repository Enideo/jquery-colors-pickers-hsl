/*
 Copyright 2010 Enideo. Released under dual MIT and GPL licenses.
*/
(function(d){function x(a,b,c){if(b in a)return a[b](c);else if(b=="RGB"||"RGB"in e.convertModels[b]){if(b!="RGB")c=e.convertModels[b].RGB(c);for(var h in a)if(h=="RGB"||h in e.convertModels.RGB){if(h!="RGB")c=e.convertModels.RGB[h](c);c=d.colors.formats.array3Octet1Normalized.fromModel.RGB(c);return a[h](c)}}throw"No valid conversion methods for this color model: "+b;}function A(a,b){var c=d.colors.models[this.currentModel].parameterIndexes,h=this.currentModel=="RGB"?this.format("array3Octet1Normalized"):
this.color;if(a){a=a.toLowerCase();if(a in c)if(b!==undefined){this.color[c[a]]=b;this.color=d.colors.models[this.currentModel].sanitize(this.color)}else return h[c[a]];else throw"Parameter not in the current color model: "+a;}else return h;return this}var e=function(a,b,c){if(this instanceof e===false)return new e(a,b,c);if(a&&a instanceof e)return a;this.currentModel=e.defaultModel;if(a){if(typeof a=="string")a=d.trim(a);this.inputColor=a;if(b&&b in e.formats&&e.formats[b].validate(a)===true)this.inputFormat=
b;else{if(c===undefined)c=b;for(b in e.formats)if(e.formats[b].validate(a)===true){this.inputFormat=b;break}}if(this.inputFormat){b=e.formats[b];this.inputModel=c||b.model||e.defaultInputModel;a=x(b.toModel,this.inputModel,a);if(this.inputModel!=this.currentModel){a=e.models[this.inputModel].sanitize(a);a=x(e.convertModels[this.inputModel],this.currentModel,a)}this.color=e.models[this.currentModel].sanitize(a)}}else this.color=e.models[this.currentModel].sanitize();if(this.color)return this;else throw"Color format unknown: "+
a;};e.fn=e.prototype={get:A,set:A,model:function(a){if(a===undefined)return this.currentModel;else if(a==this.currentModel)return this;else if(a in e.models){this.color=x(e.convertModels[this.currentModel],a,this.color);this.currentModel=a;return this}else throw"Model does not exist";},format:function(a){var b=this.currentModel=="RGB"&&a!=="array3Octet1Normalized"?this.format("array3Octet1Normalized"):this.color;if(a&&a in e.formats)return x(e.formats[a].fromModel,this.currentModel,b);else throw"Format does not exist";
},toString:function(a){if(!a||a in e.formats===false)a=e.defaultString;try{return this.format(a).toString()}catch(b){return this.format(e.defaultString).toString()}},isFormat:function(a){if(a&&a in e.formats)return e.formats[a].validate(this.inputColor);else throw"Format does not exist";}};e.formats={array3Octet:{validate:function(a,b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&c<3&&a[c]<=255&&/^\d+$/.test(a[c].toString())||c==3&&a[c]<=1)c++;else break;
if(c==b)return true}return false},toModel:{RGB:function(a){return a.slice(0,3)}},fromModel:{RGB:function(a){return a.slice(0,3)}}},array3Octet1Normalized:{validate:function(a){return e.formats.array3Octet.validate(a,4)},toModel:{RGB:function(a){return a.slice(0,4)}},fromModel:{RGB:function(a){var b=0;for(a=a.slice(0,4);b<3;){a[b]=Math.round(a[b]);b++}return a}}},rgb:{validate:function(a,b){var c=1,h;if(a&&typeof a=="string"&&(h=/^rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)$/.exec(a))){for(;c<
4;){h[c]=parseInt(h[c]);if(h[c]<256)c++;else break}if(c==4)if(b){h.shift();return h.slice(0)}else return true}return false},fromModel:{RGB:function(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}},toModel:{RGB:function(a){a=e.formats.rgb.validate(a,true);return a===false?null:a}},model:"RGB"}};e.models={RGB:{sanitize:function(a){var b;if(!a||!d.isArray(a))a=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):
a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);if(b<3){if(a[b]>255)a[b]=255;if(a[b]<0)a[b]=0}else if(b==3){a[b]=parseFloat(a[b]);if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},parameterIndexes:{r:0,g:1,b:2,a:3,red:0,green:1,blue:2,alpha:3}}};e.convertModels={};e.defaultInputModel=e.defaultModel="RGB";e.defaultString="rgb";d.colors===undefined&&d.extend({colors:e});var z={HSL:{sanitize:function(a){var b;if(!a||!d.isArray(a))a=[Math.floor(361*Math.random()),Math.floor(101*Math.random()),
Math.floor(101*Math.random()),Math.random()];for(;a.length<4;)a.length==3?a.push(1):a.push(0);a=a.slice(0,4);for(b=0;b<a.length;b++){a[b]||(a[b]=0);a[b]=parseFloat(a[b]);if(b==0){for(;a[b]>360;)a[b]-=360;if(a[b]<0)a[b]+=360}else if(b<3){for(;a[b]>100;)a[b]=100;if(a[b]<0)a[b]=0}else if(b==3){if(a[b]>1)a[b]=1;if(a[b]<0)a[b]=0}}return a},parameterIndexes:{h:0,s:1,l:2,a:3,hue:0,saturation:1,lightness:2,alpha:3},cycleMixes:[360,0,0,0],reverseCylce:function(a){this.cycleMixes[this.parameterIndexes[a]]*=
-1}}},B={array1Circle2Percentage:{validate:function(a,b){var c=0;b=b||3;if(d.isArray(a)&&a.length==b){for(;c<b;)if(typeof a[c]=="number"&&a[c]>=0&&(c==0&&a[c]<=360||(c==1||c==2)&&a[c]<=100||c==3&&a[c]<=1))c++;else break;if(c==b)return true}return false},toModel:{HSL:function(a){return a.slice(0,3)}},fromModel:{HSL:function(a){return a.slice(0,3)}}},array1Circle2Percentage1Normalized:{validate:function(a){return B.array1Circle2Percentage.validate(a,4)},toModel:{HSL:function(a){return a.slice(0,4)}},
fromModel:{HSL:function(a){return a.slice(0,4)}}}};d.extend(true,d.colors.convertModels,{RGB:{HSL:function(a){var b=a[0]/255,c=a[1]/255,h=a[2]/255,n=Math.max(b,c,h),o=Math.min(b,c,h),r=n-o,s=(n+o)/2;if(n==o)b=o=0;else{o=s>0.5?r/(2-n-o):r/(n+o);b=n==b?(c-h)/r+(c<h?6:0):n==c?(h-b)/r+2:(b-c)/r+4;b/=6}return[b*360,o*100,s*100,a[3]]}},HSL:{RGB:function(a){function b(s,q,p){if(p<0)p+=1;if(p>1)p-=1;return p<1/6?s+(q-s)*6*p:p<0.5?q:p<2/3?s+(q-s)*(2/3-p)*6:s}var c,h,n,o,r;n=a[0]/360;h=a[1]/100;c=a[2]/100;
if(h==0)c=h=n=c;else{o=c<0.5?c*(1+h):c+h-c*h;r=2*c-o;c=b(r,o,n+1/3);h=b(r,o,n);n=b(r,o,n-1/3)}return[c*255,h*255,n*255,a[3]]}}});d.extend(d.colors.models,z);d.extend(d.colors.formats,B)})(jQuery);
(function(d){function x(){var f=d("<div/>").addClass("scale"),j=d("<div/>").css({zIndex:1,width:160,height:160}),l=d("<span/>").css({position:"absolute",zIndex:3}),m=l.clone().addClass("outline").css({zIndex:2}),g=d("<span/>").addClass("handle");j.add(g).css({position:"absolute",top:0,left:0});q=d("<div/>").addClass("hslCircleColorPicker").css({position:"relative",width:160,height:185});q.append(f.clone().addClass("h").data("arrayIndex",0).addClass("hSprite").css({width:160,height:160}).append(j.clone().addClass("hSprite").css({backgroundPosition:"-320px 0"})).append(j.clone().addClass("hSprite").css({backgroundPosition:"-160px 0"})));
f.css({overflow:"hidden"});j.css({backgroundRepeat:"repeat-x",width:20,height:100});q.append(f.clone().addClass("s").data("arrayIndex",1).css({width:20,height:100,position:"absolute",top:30,left:70}).append(j.clone().addClass("sSprite").css({backgroundPosition:"0 -200px"})).append(j.clone().addClass("sSprite")).append(j.clone().addClass("sSprite").css({backgroundPosition:"0 -100px"})));q.append(f.clone().addClass("l").data("arrayIndex",2).css({height:20,position:"absolute",top:165,left:0,right:0}));
s.append(q);p=q.children("div");p.each(function(v){var i=d(this);if(v==0){i.append(g.clone().append(l.clone().text("+")).append(m.clone().text("+")));i.children("span").children().each(function(){var k=d(this);k.css({top:-k.height()/2,left:-k.width()/2})})}else if(v==1){i.append(g.clone().append(l.clone().text("\u25b6")).append(l.clone().text("\u25c0")).append(m.clone().text("\u25b6")).append(m.clone().text("\u25c0")));i.children("span").css({right:2}).children().each(function(k){var u=d(this);leftOrRight=
"left";if(k%2!=0)leftOrRight="right";u.css({top:-u.height()/2}).css(leftOrRight,-u.width()/2)})}else if(v==2){i.append(g.clone().append(l.clone().text("\u25bc")).append(l.clone().text("\u25b2")).append(m.clone().text("\u25bc")).append(m.clone().text("\u25b2")));i.children("span").css({bottom:2}).children().each(function(k){var u=d(this);topOrBottom="top";if(k%2!=0)topOrBottom="bottom";u.css({left:-u.width()/2-1}).css(topOrBottom,-u.height()/2)})}});c=[Math.random()*360,Math.random()*100,Math.random()*
100];h=false;n=o=r=null;p.mousedown(A)}function A(f){function j(i){var k=100;if(v==0){i=Math.atan2(i.pageX-g.left,g.top-i.pageY)/6.28;if(i<0)i+=1;k=360}else i=v==1?(100-(i.pageY-g.top))/100:(i.pageX-g.left)/160;i=i>1?1:i<0?0:i;c[v]=i*k;e();d.isFunction(o)&&o(d.colors(c,"array1Circle2Percentage","HSL"));return false}function l(){d.isFunction(r)&&r(d.colors(c,"array1Circle2Percentage","HSL"));d(document).unbind("mousemove",j).unbind("mouseup",l);q.data("dragging",false)}var m=d(f.currentTarget),g=m.offset(),
v=m.data("arrayIndex");if(v==0){g.top+=80;g.left+=80}z(d(this).closest(".hslCircleColorPicker").parent());if(h)return true;d.isFunction(n)&&n(d.colors(c,"array1Circle2Percentage","HSL"));if(!q.data("dragging")){d(document).bind("mousemove",j).bind("mouseup",l);q.data("dragging",true)}j(f);return false}function e(){var f,j;p.each(function(){var m=d(this),g=m.data("arrayIndex");m=m.children("span");if(g==0){g=c[g]/360*6.28;m.css({top:-Math.cos(g)*70+80,left:Math.sin(g)*70+80})}else g==1?m.css({top:98-
c[g]*100/100}):m.css({left:c[g]*160/100})});var l=c[2]/100;j=(100-c[1])/100;f=[l*j,(1-l)*j];if(c[2]>50){j=(c[2]-50)*2/100;f[0]=Math.max(f[0],j)}else{j=(50-c[2])*2/100;f[1]=Math.max(f[1],j)}p.filter(".h").children("div").each(function(m){d(this).css("opacity",f[m])});f=c[2]>50?[j,1-j,0]:[0,1-j,j];p.filter(".s").css({backgroundColor:d.colors([c[0],100,50],"array1Circle2Percentage","HSL").toString("rgb")}).children("div").each(function(m){d(this).css("opacity",f[m])});p.filter(".l").css({backgroundColor:d.colors([c[0],
c[1],50],"array1Circle2Percentage","HSL").toString("rgb")})}function z(f){s=f;if(s.data("hslCircleColorPickerId")){q=s.children();p=q.children("div.scale");t=s.data("hslCircleColorPickerId");c=b[t].hsl;h=b[t].disabled;n=b[t].onStartChange;o=b[t].onChange;r=b[t].onEndChange}else{t=(new Date).getTime();s.data("hslCircleColorPickerId",t);x();b[t]={hsl:c,disabled:h,onStartChange:n,onChange:o,onEndChange:r}}}function B(){function f(j){var l,m,g,v,i=[[".hslCircleColorPicker",["display","inline-block"]],
[".hslCircleColorPicker>div.scale",["border","1px solid #888"],["cursor","crosshair"]],[".hslCircleColorPicker>div.scale.h",["border-width","0 !important"]],[".hslCircleColorPicker>div.scale.s",["cursor","NS-resize"],["cursor","row-resize"]],[".hslCircleColorPicker>div.scale.l",["cursor","EW-resize"],["cursor","col-resize"]],[".hslCircleColorPicker>div.scale>span.handle>span",["color","#eee"],["font-size","16px"]],[".hslCircleColorPicker>div.scale>span.handle>span.outline",["color","#333"],["font-size",
"18px"]],[".hslCircleColorPicker.disabled>div.scale",["cursor","default"]],[".hslCircleColorPicker.disabled>div.scale>span.handle>span",["opacity","0.5"],["filter","alpha(opacity=50)"]]],k,u,y=document.getElementsByTagName("link");if(y.length==0)y=document.getElementsByTagName("style");if(j===true||this.width!=1||this.height!=1)i=i.concat([[".hslCircleColorPicker .hSprite",["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.sprite.h.png')"]],[".hslCircleColorPicker .sSprite",
["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.sprite.s.png')"]],[".hslCircleColorPicker>div.scale.l",["background-image","url('"+d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.l.png')"]]]);else{k=document.createElement("link");k.type="text/css";k.charset="utf-8";k.rel="stylesheet";k.href=d.colors.pickers.hslCircle.pathToImages+"jquery.colors.pickers.hslCircle.css";y.length!=0?document.getElementsByTagName("head")[0].insertBefore(k,
y[0]):document.getElementsByTagName("head")[0].appendChild(k)}k=document.createElement("style");k.type="text/css";k.charset="utf-8";k.rel="stylesheet";l=0;for(m=i.length;l<m;l++){u=[i[l][0],"{"];g=1;for(v=i[l].length;g<v;g++)u.push(i[l][g].join(":"),";");u.push("}");i[l]=u.join("")}i=i.join("");y.length!=0?document.getElementsByTagName("head")[0].insertBefore(k,y[0]):document.getElementsByTagName("head")[0].appendChild(k);if(k.styleSheet)k.styleSheet.cssText=i;else d(k).text(i);j!==true&&d(this).remove()}
a=true;/MSIE/.test(navigator.appVersion)?f(true):d("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==").one("error load",f).appendTo("body")}var a,b={},c,h,n,o,r,s,q,p,t;d.fn.hslCircleColorPicker=function(f){var j,l=[];if(typeof f=="string"&&this.data("hslCircleColorPickerId"))return f==="color"?d.colors(b[this.data("hslCircleColorPickerId")].hsl,"array1Circle2Percentage","HSL"):b[this.data("hslCircleColorPickerId")][f];a||B();j=this.each(function(){z(d(this));
if(typeof f=="object"){var m=d.colors.models.HSL.parameterIndexes,g;for(g in f){if(g in m){b[t].hsl[m[g]]=f[g];delete f[g]}if(g==="color"){if(f[g]instanceof d.colors===false)f[g]=d.colors(f[g]);b[t].hsl=f[g].model("HSL").format("array1Circle2Percentage");delete f[g]}}d.extend(b[t],f);b[t].hsl=d.colors.models.HSL.sanitize(b[t].hsl).slice(0,3);z(s);if("disabled"in f)f.disabled?q.addClass("disabled"):q.removeClass("disabled")}else f==="hsl"&&l.push(c);e()});return l.length>1?l:l.length==1?l[0]:j};if(d.colors.pickers===
undefined)d.colors.pickers={};var w=d("script[src]");if(w.length>0){w=w.eq(w.length-1).attr("src").split("/");w.pop();w=w.join("/")+"/"}else w="";d.colors.pickers.hslCircle={pathToImages:w}})(jQuery);
